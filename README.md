![Screenshot](/img/screenshot.png)  
[![!#/bin/bash](https://img.shields.io/badge/-%23!%2Fbin%2Fbash-1f425f.svg?logo=image%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw%2FeHBhY2tldCBiZWdpbj0i77u%2FIiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8%2BIDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkE3MDg2QTAyQUZCMzExRTVBMkQxRDMzMkJDMUQ4RDk3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkE3MDg2QTAzQUZCMzExRTVBMkQxRDMzMkJDMUQ4RDk3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTcwODZBMDBBRkIzMTFFNUEyRDFEMzMyQkMxRDhEOTciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTcwODZBMDFBRkIzMTFFNUEyRDFEMzMyQkMxRDhEOTciLz4gPC9yZGY6RGVzY3JpcHRpb24%2BIDwvcmRmOlJERj4gPC94OnhtcG1ldGE%2BIDw%2FeHBhY2tldCBlbmQ9InIiPz6lm45hAAADkklEQVR42qyVa0yTVxzGn7d9Wy03MS2ii8s%2BeokYNQSVhCzOjXZOFNF4jx%2BMRmPUMEUEqVG36jo2thizLSQSMd4N8ZoQ8RKjJtooaCpK6ZoCtRXKpRempbTv5ey83bhkAUphz8fznvP8znn%2B%2F3NeEEJgNBoRRSmz0ub%2FfuxEacBg%2FDmYtiCjgo5NG2mBXq%2BH5I1ogMRk9Zbd%2BQU2e1ML6VPLOyf5tvBQ8yT1lG10imxsABm7SLs898GTpyYynEzP60hO3trHDKvMigUwdeaceacqzp7nOI4n0SSIIjl36ao4Z356OV07fSQAk6xJ3XGg%2BLCr1d1OYlVHp4eUHPnerU79ZA%2F1kuv1JQMAg%2BE4O2P23EumF3VkvHprsZKMzKwbRUXFEyTvSIEmTVbrysp%2BWr8wfQHGK6WChVa3bKUmdWou%2BjpArdGkzZ41c1zG%2Fu5uGH4swzd561F%2BuhIT4%2BLnSuPsv9%2BJKIpjNr9dXYOyk7%2FBZrcjIT4eCnoKgedJP4BEqhG77E3NKP31FO7cfQA5K0dSYuLgz2TwCWJSOBzG6crzKK%2BohNfni%2Bx6OMUMMNe%2Fgf7ocbw0v0acKg6J8Ql0q%2BT%2FAXR5PNi5dz9c71upuQqCKFAD%2BYhrZLEAmpodaHO3Qy6TI3NhBpbrshGtOWKOSMYwYGQM8nJzoFJNxP2HjyIQho4PewK6hBktoDcUwtIln4PjOWzflQ%2Be5yl0yCCYgYikTclGlxadio%2BBQCSiW1UXoVGrKYwH4RgMrjU1HAB4vR6LzWYfFUCKxfS8Ftk5qxHoCUQAUkRJaSEokkV6Y%2F%2BJUOC4hn6A39NVXVBYeNP8piH6HeA4fPbpdBQV5KOx0QaL1YppX3Jgk0TwH2Vg6S3u%2BdB91%2B%2FpuNYPYFl5uP5V7ZqvsrX7jxqMXR6ff3gCQSTzFI0a1TX3wIs8ul%2Bq4HuWAAiM39vhOuR1O1fQ2gT%2F26Z8Z5vrl2OHi9OXZn995nLV9aFfS6UC9JeJPfuK0NBohWpCHMSAAsFe74WWP%2BvT25wtP9Bpob6uGqqyDnOtaeumjRu%2ByFu36VntK%2FPA5umTJeUtPWZSU9BCgud661odVp3DZtkc7AnYR33RRC708PrVi1larW7XwZIjLnd7R6SgSqWSNjU1B3F72pz5TZbXmX5vV81Yb7Lg7XT%2FUXriu8XLVqw6c6XqWnBKiiYU%2BMt3wWF7u7i91XlSEITwSAZ%2FCzAAHsJVbwXYFFEAAAAASUVORK5CYII%3D)](https://www.gnu.org/software/bash/)  [![npm version](https://badge.fury.io/js/ver-bump.svg)](https://badge.fury.io/js/ver-bump)  [![Publish NPM Package](https://github.com/jv-k/ver-bump/actions/workflows/npm-publish.yml/badge.svg)](https://github.com/jv-k/ver-bump/actions/workflows/npm-publish.yml)  [![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square)](http://makeapullrequest.com)  [![License](https://img.shields.io/npm/l/@jsdevtools/npm-publish.svg)](LICENSE)

 A fully automated handy CLI utility that takes care of releasing GitHub software projects, written in 100% pure bash.

## Highlights üì¶üöÄ
It does several things that are typically required for releasing a Git repository:
  - Create a release branch from your current branch (should be a feature or develop branch, following the [Git branch-based workflow](https://nvie.com/posts/a-successful-git-branching-model/), and [tags](https://git-scm.com/book/en/v2/Git-Basics-Tagging) the release
  - Enforces [Semantic Versioning](https://semver.org/) specification
  - Avoid potential mistakes associated with manual releases, such as forgetting a step
  - Create and update a changelog file automatically
  - Pushes release to a remote
  - Leaves merging the release branch to the development branch to the user

## Release Steps üë£
The command `ver-bump` will execute the following steps:

### Verify + Prepare Release
  - Verify some commits exist
  - Selects a semantic version number for the release branch & tag
  - Increments / suggests a semantic version number for the release and its tag 
    - Checks to see a tagged release with the chosen version already exists

### Create Release
  - Bump version number in `package.json`
  - Write `CHANGELOG.md`
  - Create release branch
  - Commit changes to files made by this script
  - Create a Git tag
  - Push release branch + tag to remote

## Release Steps: In detail üîé

<table>
  <thead>
    <tr>
      <th></th>
      <th>Step</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="5">Verify + Prepare Release</td>
      <td>Process user arguments</td>
      <td>Check and store CLI arguments supplied by user for later processing.</td>
    </tr>
    <tr>
      <td>Check commits</td>
      <td>Verify some commits exist for release.</td>
    </tr>
    <tr>
      <td>Determine Release Version</td>
      <td>If <code>&lt;package.json&gt;</code> doesn't exist, warn + exit. <br><br>If <code>-v</code> option is
        specified, set version from that.<br><br> Or, grab from version from <code>package.json</code>.<br><br>Suggest
        incremented version number in the form of <code>MAJOR.MINOR.PATCH</code> (incrementing <code>PATCH</code>), as
        per Semver 2.0.0.<br><br>Give the user the option to modify/confirm suggested version bump.</td>
    </tr>
    <tr>
      <td>Check branch exist</td>
      <td>Ensure a release branch with the chosen version number doesn't already exist, if so exit.</td>
    </tr>
    <tr>
      <td>Check tag exists</td>
      <td>Ensure a tag with the chosen version number doesn't exist, and exit if it does.</td>
    </tr>
    <tr>
      <td rowspan="6">Create Release</td>
      <td>Bump version number</td>
      <td>Update semantic version number in <code>package.json</code> + stages changes.</td>
    </tr>
    <tr>
      <td>Generate changelog</td>
      <td>Commits since the last release are automatically added to <code>CHANGELOG.md</code>, as well as new commit
        messages for files modified by this script itself. Stages changes for commit action later.</td>
    </tr>
    <tr>
      <td>Create release branch</td>
      <td>Create a branch with the name <code>release-MAJOR.MINOR.PATCH</code> and switch to it (following the <a
          href="https://nvie.com/posts/a-successful-git-branching-model/" rel="nofollow">Git branch-based
          workflow</a>).</td>
    </tr>
    <tr>
      <td>Commit changed files</td>
      <td>Commits changes to <code>package.json</code> and CHANGELOG.md` (staged in the previous steps) to the release
        branch.</td>
    </tr>
    <tr>
      <td>Create Git tag</td>
      <td>Create a Git tag referencing the new release version.</td>
    </tr>
    <tr>
      <td>Push</td>
      <td>Optionally, push the release branch to origin.</td>
    </tr>
  </tbody>
</table>

## Requirements
In order to use `ver-bump` you need:
  - To host your project code in a Git repository
  - Have Git installed in your environment
  - Have `npm` and `node` installed

Note: ‚ö†Ô∏è `ver-bump` has only been tested on **MacOS Darwin**.

## Installation
Install the script globally via npm, and use it in any local Git repository to release your project:
```sh
$ npm install -g ver-bump
```

## Usage
### Pre-requisites
  - Make sure you have `package.json` file in your project and it contains a `"version": "x.x.x"` parameter
  - You have done some work and have some existing commits
  - You have the ability to push to your Git remote via the Git CLI

### CLI
```sh
$ ver-bump [-v <version no.>] [-m <release message>] [-j <file1>] [-j <file2>].. [-n] [-p] [-b] [-h]
```

## Options
```
-v <version number>     Specify a manual version number
-m <release message>    Custom release message
-f <filename.json>      Update version number inside JSON files.
                            * For multiple files, add a separate -f option for each one,
                            * For example: ./ver-bump.sh -f src/plugin/package.json -f composer.json
-p <repository alias>   Push commits to remote repository, eg `-p Origin`
-n                      Turns off automatic commit
                            * You may want to do that yourself, for example.
-b                      Don't create automatic `release-<version>` branch
-h 	                    Show help message.
```

## Example - create a release
1. This will create a new branch called `release-1.0.1` and a tag named `v1.0.1. Make sure that you're checking out the branch that you want to release (for example, your development branch):
    ```sh
    $ ver-bump
    ```
    `ver-bump` will output:
    ```sh
    Current version read from <package.json> file: 1.0.0

    Enter a new version number or press <enter> to use [1.0.1]: <pressed enter>

    ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì

    ‚úÖ Updated file <package.json> from 1.0.0 -> 1.0.1

    ‚úÖ Updated [CHANGELOG.md] file

    Make adjustments to [CHANGELOG.md] if required now. Press <enter> to continue.

    Creating new release branch...

    ‚úÖ Switched to branch 'release-1.0.1'
    M	CHANGELOG.md
    M	package.json

    Committing...

    ‚úÖ [release-1.0.1 ace8b1e] Updated package.json, Updated CHANGELOG.md, Bumped 1.0.0 ‚Äì> 1.0.1
    2 files changed, 9 insertions(+), 1 deletion(-)

    ‚úÖ Added GIT tag

    Push tags to <origin>? [N/y]: n

    ‚Äì‚Äì‚Äì‚Äì‚Äì‚Äì

    ‚úÖ Bumped 1.0.0 ‚Äì> 1.0.1

    üèÅ Done!
    ```
2. After checking out the changes in the branch and confirming them, test the release, and push the release branch to your remote if you didn't choose to push it automatically. Alternatively, use `$ ver-bump -p origin` to bypass the prompt and push the release branch anyway to the remote automatically.
3. If your code checks out, then open a Pull Request to merge the release branch into your `develop` or main branch. 

    You can merge the release branch into your development branch or main branch like this, without fast-forwarding so that the branch topology is preseved as you're merging in a release branch that hasn't diverged (apart from new changes to `CHANGELOG.md` and `package.json`) and you want to ensure it's clearly evident when reading the history that a merge was performed, as opposed to a fast-forward merge, where new commits performed by the merge will become descendents of the last commit before the merge. 
    
    A release branch shouldn't normally diverge from the branch it was created during the time `ver-bump` is operating, so a non-fastforward should be possible instead of a normal merge, which would simply looks like a new commit was made to the main or development branch.
    ```sh
    $ git checkout develop # Switch to development branch from the new release branch

    $ git merge --no-ff release-1.0.1 # Merge the new release branch to your development branch
    ```

## Contributing
I'd love you to contribute to `@jv-k/ver-bump`, pull requests are welcome! Please see [/jv-k/ver-bump/issues/new/choose](https://github.com/jv-k/ver-bump/issues/new/choose) for submitting issues and bugs.

## License
The scripts and documentation in this project are released under the [MIT license.](https://github.com/jv-k/ver-bump/blob/master/LICENSE).
